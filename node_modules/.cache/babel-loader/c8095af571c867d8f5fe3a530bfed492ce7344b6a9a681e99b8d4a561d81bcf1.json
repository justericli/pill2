{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{createContext,useState,useEffect}from\"react\";import{CognitoUser,AuthenticationDetails}from\"amazon-cognito-identity-js\";import Pool from\"../User_Userpool.jsx\";import{jsx as _jsx}from\"react/jsx-runtime\";var AccountContext=/*#__PURE__*/createContext();var User_Account=function User_Account(props){var children=props.children;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),authenticated=_useState2[0],setAuthenticated=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),userName=_useState4[0],setUserName=_useState4[1];useEffect(function(){console.log(\"Authenticated: \",authenticated);},[authenticated]);var getSession=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return new Promise(function(resolve,reject){var user=Pool.getCurrentUser();if(user){user.getSession(function(err,session){if(err){reject();}else{// Set the username state here\nsetUserName(session.getIdToken().payload[\"cognito:username\"]);resolve(session);}});}else{reject();}});case 2:return _context.abrupt(\"return\",_context.sent);case 3:case\"end\":return _context.stop();}},_callee);}));return function getSession(){return _ref.apply(this,arguments);};}();var authenticate=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(Username,Password){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return new Promise(function(resolve,reject){var user=new CognitoUser({Username:Username,Pool:Pool});var authDetails=new AuthenticationDetails({Username:Username,Password:Password});user.authenticateUser(authDetails,{onSuccess:function onSuccess(data){console.log(\"onSuccess: \",data);resolve(data);},onFailure:function onFailure(err){console.error(\"onFailure: \",err);reject(err);},newPasswordRequired:function newPasswordRequired(data){console.log(\"newPasswordRequired: \",data);resolve(data);}});});case 2:return _context2.abrupt(\"return\",_context2.sent);case 3:case\"end\":return _context2.stop();}},_callee2);}));return function authenticate(_x,_x2){return _ref2.apply(this,arguments);};}();var logout=function logout(){var user=Pool.getCurrentUser();if(user){user.signOut();}};return/*#__PURE__*/_jsx(AccountContext.Provider,{value:{authenticate:authenticate,getSession:getSession,logout:logout,authenticated:authenticated,setAuthenticated:setAuthenticated,userName:userName// Provide the username through context\n},children:children});};export default User_Account;export{AccountContext};","map":{"version":3,"names":["React","createContext","useState","useEffect","CognitoUser","AuthenticationDetails","Pool","jsx","_jsx","AccountContext","User_Account","props","children","_useState","_useState2","_slicedToArray","authenticated","setAuthenticated","_useState3","_useState4","userName","setUserName","console","log","getSession","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","Promise","resolve","reject","user","getCurrentUser","err","session","getIdToken","payload","abrupt","sent","stop","apply","arguments","authenticate","_ref2","_callee2","Username","Password","_callee2$","_context2","authDetails","authenticateUser","onSuccess","data","onFailure","error","newPasswordRequired","_x","_x2","logout","signOut","Provider","value"],"sources":["/Users/ericli/Desktop/pill2/src/components/User_Account.jsx"],"sourcesContent":["import React, { createContext, useState, useEffect } from \"react\";\nimport { CognitoUser, AuthenticationDetails } from \"amazon-cognito-identity-js\";\nimport Pool from \"../User_Userpool.jsx\";\n\nconst AccountContext = createContext();\n\nconst User_Account = (props) => {\n  const { children } = props;\n  const [authenticated, setAuthenticated] = useState(false);\n  const [userName, setUserName] = useState(\"\");\n\n  useEffect(() => {\n    console.log(\"Authenticated: \", authenticated);\n  }, [authenticated]);\n\n  const getSession = async () => {\n    return await new Promise((resolve, reject) => {\n      const user = Pool.getCurrentUser();\n      if (user) {\n        user.getSession((err, session) => {\n          if (err) {\n            reject();\n          } else {\n            // Set the username state here\n            setUserName(session.getIdToken().payload[\"cognito:username\"]);\n            resolve(session);\n          }\n        });\n      } else {\n        reject();\n      }\n    });\n  };\n\n  const authenticate = async (Username, Password) => {\n    return await new Promise((resolve, reject) => {\n      const user = new CognitoUser({\n        Username,\n        Pool: Pool,\n      });\n\n      const authDetails = new AuthenticationDetails({\n        Username,\n        Password,\n      });\n\n      user.authenticateUser(authDetails, {\n        onSuccess: (data) => {\n          console.log(\"onSuccess: \", data);\n          resolve(data);\n        },\n        onFailure: (err) => {\n          console.error(\"onFailure: \", err);\n          reject(err);\n        },\n        newPasswordRequired: (data) => {\n          console.log(\"newPasswordRequired: \", data);\n          resolve(data);\n        },\n      });\n    });\n  };\n\n  const logout = () => {\n    const user = Pool.getCurrentUser();\n    if (user) {\n      user.signOut();\n    }\n  };\n\n  return (\n    <AccountContext.Provider\n      value={{\n        authenticate,\n        getSession,\n        logout,\n        authenticated,\n        setAuthenticated,\n        userName, // Provide the username through context\n      }}\n    >\n      {children}\n    </AccountContext.Provider>\n  );\n};\n\nexport default User_Account;\nexport { AccountContext };\n"],"mappings":"mWAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CACjE,OAASC,WAAW,CAAEC,qBAAqB,KAAQ,4BAA4B,CAC/E,MAAO,CAAAC,IAAI,KAAM,sBAAsB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAExC,GAAM,CAAAC,cAAc,cAAGR,aAAa,EAAE,CAEtC,GAAM,CAAAS,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAIC,KAAK,CAAK,CAC9B,GAAQ,CAAAC,QAAQ,CAAKD,KAAK,CAAlBC,QAAQ,CAChB,IAAAC,SAAA,CAA0CX,QAAQ,CAAC,KAAK,CAAC,CAAAY,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAlDG,aAAa,CAAAF,UAAA,IAAEG,gBAAgB,CAAAH,UAAA,IACtC,IAAAI,UAAA,CAAgChB,QAAQ,CAAC,EAAE,CAAC,CAAAiB,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAArCE,QAAQ,CAAAD,UAAA,IAAEE,WAAW,CAAAF,UAAA,IAE5BhB,SAAS,CAAC,UAAM,CACdmB,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAEP,aAAa,CAAC,CAC/C,CAAC,CAAE,CAACA,aAAa,CAAC,CAAC,CAEnB,GAAM,CAAAQ,UAAU,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAA,SAAAF,mBAAA,GAAAG,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAE,IAAA,SACJ,IAAI,CAAAC,OAAO,CAAC,SAACC,OAAO,CAAEC,MAAM,CAAK,CAC5C,GAAM,CAAAC,IAAI,CAAGhC,IAAI,CAACiC,cAAc,EAAE,CAClC,GAAID,IAAI,CAAE,CACRA,IAAI,CAACd,UAAU,CAAC,SAACgB,GAAG,CAAEC,OAAO,CAAK,CAChC,GAAID,GAAG,CAAE,CACPH,MAAM,EAAE,CACV,CAAC,IAAM,CACL;AACAhB,WAAW,CAACoB,OAAO,CAACC,UAAU,EAAE,CAACC,OAAO,CAAC,kBAAkB,CAAC,CAAC,CAC7DP,OAAO,CAACK,OAAO,CAAC,CAClB,CACF,CAAC,CAAC,CACJ,CAAC,IAAM,CACLJ,MAAM,EAAE,CACV,CACF,CAAC,CAAC,eAAAL,QAAA,CAAAY,MAAA,UAAAZ,QAAA,CAAAa,IAAA,0BAAAb,QAAA,CAAAc,IAAA,MAAAjB,OAAA,GACH,kBAjBK,CAAAL,UAAUA,CAAA,SAAAC,IAAA,CAAAsB,KAAA,MAAAC,SAAA,OAiBf,CAED,GAAM,CAAAC,YAAY,6BAAAC,KAAA,CAAAxB,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAuB,SAAOC,QAAQ,CAAEC,QAAQ,SAAA1B,mBAAA,GAAAG,IAAA,UAAAwB,UAAAC,SAAA,iBAAAA,SAAA,CAAAtB,IAAA,CAAAsB,SAAA,CAAArB,IAAA,SAAAqB,SAAA,CAAArB,IAAA,SAC/B,IAAI,CAAAC,OAAO,CAAC,SAACC,OAAO,CAAEC,MAAM,CAAK,CAC5C,GAAM,CAAAC,IAAI,CAAG,GAAI,CAAAlC,WAAW,CAAC,CAC3BgD,QAAQ,CAARA,QAAQ,CACR9C,IAAI,CAAEA,IACR,CAAC,CAAC,CAEF,GAAM,CAAAkD,WAAW,CAAG,GAAI,CAAAnD,qBAAqB,CAAC,CAC5C+C,QAAQ,CAARA,QAAQ,CACRC,QAAQ,CAARA,QACF,CAAC,CAAC,CAEFf,IAAI,CAACmB,gBAAgB,CAACD,WAAW,CAAE,CACjCE,SAAS,CAAE,SAAAA,UAACC,IAAI,CAAK,CACnBrC,OAAO,CAACC,GAAG,CAAC,aAAa,CAAEoC,IAAI,CAAC,CAChCvB,OAAO,CAACuB,IAAI,CAAC,CACf,CAAC,CACDC,SAAS,CAAE,SAAAA,UAACpB,GAAG,CAAK,CAClBlB,OAAO,CAACuC,KAAK,CAAC,aAAa,CAAErB,GAAG,CAAC,CACjCH,MAAM,CAACG,GAAG,CAAC,CACb,CAAC,CACDsB,mBAAmB,CAAE,SAAAA,oBAACH,IAAI,CAAK,CAC7BrC,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAEoC,IAAI,CAAC,CAC1CvB,OAAO,CAACuB,IAAI,CAAC,CACf,CACF,CAAC,CAAC,CACJ,CAAC,CAAC,eAAAJ,SAAA,CAAAX,MAAA,UAAAW,SAAA,CAAAV,IAAA,0BAAAU,SAAA,CAAAT,IAAA,MAAAK,QAAA,GACH,kBA3BK,CAAAF,YAAYA,CAAAc,EAAA,CAAAC,GAAA,SAAAd,KAAA,CAAAH,KAAA,MAAAC,SAAA,OA2BjB,CAED,GAAM,CAAAiB,MAAM,CAAG,QAAT,CAAAA,MAAMA,CAAA,CAAS,CACnB,GAAM,CAAA3B,IAAI,CAAGhC,IAAI,CAACiC,cAAc,EAAE,CAClC,GAAID,IAAI,CAAE,CACRA,IAAI,CAAC4B,OAAO,EAAE,CAChB,CACF,CAAC,CAED,mBACE1D,IAAA,CAACC,cAAc,CAAC0D,QAAQ,EACtBC,KAAK,CAAE,CACLnB,YAAY,CAAZA,YAAY,CACZzB,UAAU,CAAVA,UAAU,CACVyC,MAAM,CAANA,MAAM,CACNjD,aAAa,CAAbA,aAAa,CACbC,gBAAgB,CAAhBA,gBAAgB,CAChBG,QAAQ,CAARA,QAAU;AACZ,CAAE,CAAAR,QAAA,CAEDA,QAAQ,EACe,CAE9B,CAAC,CAED,cAAe,CAAAF,YAAY,CAC3B,OAASD,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}