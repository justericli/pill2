{"ast":null,"code":"import { HttpRequest } from \"@aws-sdk/protocol-http\";\nimport { getUserAgentPrefix } from \"@aws-sdk/util-endpoints\";\nimport { SPACE, UA_ESCAPE_REGEX, USER_AGENT, X_AMZ_USER_AGENT } from \"./constants\";\nexport const userAgentMiddleware = options => (next, context) => async args => {\n  const {\n    request\n  } = args;\n  if (!HttpRequest.isInstance(request)) return next(args);\n  const {\n    headers\n  } = request;\n  const userAgent = context?.userAgent?.map(escapeUserAgent) || [];\n  const defaultUserAgent = (await options.defaultUserAgentProvider()).map(escapeUserAgent);\n  const customUserAgent = options?.customUserAgent?.map(escapeUserAgent) || [];\n  const prefix = getUserAgentPrefix();\n  const sdkUserAgentValue = (prefix ? [prefix] : []).concat([...defaultUserAgent, ...userAgent, ...customUserAgent]).join(SPACE);\n  const normalUAValue = [...defaultUserAgent.filter(section => section.startsWith(\"aws-sdk-\")), ...customUserAgent].join(SPACE);\n  if (options.runtime !== \"browser\") {\n    if (normalUAValue) {\n      headers[X_AMZ_USER_AGENT] = headers[X_AMZ_USER_AGENT] ? `${headers[USER_AGENT]} ${normalUAValue}` : normalUAValue;\n    }\n    headers[USER_AGENT] = sdkUserAgentValue;\n  } else {\n    headers[X_AMZ_USER_AGENT] = sdkUserAgentValue;\n  }\n  return next({\n    ...args,\n    request\n  });\n};\nconst escapeUserAgent = _ref => {\n  let [name, version] = _ref;\n  const prefixSeparatorIndex = name.indexOf(\"/\");\n  const prefix = name.substring(0, prefixSeparatorIndex);\n  let uaName = name.substring(prefixSeparatorIndex + 1);\n  if (prefix === \"api\") {\n    uaName = uaName.toLowerCase();\n  }\n  return [prefix, uaName, version].filter(item => item && item.length > 0).map(item => item?.replace(UA_ESCAPE_REGEX, \"_\")).join(\"/\");\n};\nexport const getUserAgentMiddlewareOptions = {\n  name: \"getUserAgentMiddleware\",\n  step: \"build\",\n  priority: \"low\",\n  tags: [\"SET_USER_AGENT\", \"USER_AGENT\"],\n  override: true\n};\nexport const getUserAgentPlugin = config => ({\n  applyToStack: clientStack => {\n    clientStack.add(userAgentMiddleware(config), getUserAgentMiddlewareOptions);\n  }\n});","map":{"version":3,"names":["HttpRequest","getUserAgentPrefix","SPACE","UA_ESCAPE_REGEX","USER_AGENT","X_AMZ_USER_AGENT","userAgentMiddleware","options","next","context","args","request","isInstance","headers","userAgent","map","escapeUserAgent","defaultUserAgent","defaultUserAgentProvider","customUserAgent","prefix","sdkUserAgentValue","concat","join","normalUAValue","filter","section","startsWith","runtime","_ref","name","version","prefixSeparatorIndex","indexOf","substring","uaName","toLowerCase","item","length","replace","getUserAgentMiddlewareOptions","step","priority","tags","override","getUserAgentPlugin","config","applyToStack","clientStack","add"],"sources":["/Users/ericli/Desktop/pill2/node_modules/@aws-sdk/client-s3/node_modules/@aws-sdk/middleware-user-agent/dist-es/user-agent-middleware.js"],"sourcesContent":["import { HttpRequest } from \"@aws-sdk/protocol-http\";\nimport { getUserAgentPrefix } from \"@aws-sdk/util-endpoints\";\nimport { SPACE, UA_ESCAPE_REGEX, USER_AGENT, X_AMZ_USER_AGENT } from \"./constants\";\nexport const userAgentMiddleware = (options) => (next, context) => async (args) => {\n    const { request } = args;\n    if (!HttpRequest.isInstance(request))\n        return next(args);\n    const { headers } = request;\n    const userAgent = context?.userAgent?.map(escapeUserAgent) || [];\n    const defaultUserAgent = (await options.defaultUserAgentProvider()).map(escapeUserAgent);\n    const customUserAgent = options?.customUserAgent?.map(escapeUserAgent) || [];\n    const prefix = getUserAgentPrefix();\n    const sdkUserAgentValue = (prefix ? [prefix] : [])\n        .concat([...defaultUserAgent, ...userAgent, ...customUserAgent])\n        .join(SPACE);\n    const normalUAValue = [\n        ...defaultUserAgent.filter((section) => section.startsWith(\"aws-sdk-\")),\n        ...customUserAgent,\n    ].join(SPACE);\n    if (options.runtime !== \"browser\") {\n        if (normalUAValue) {\n            headers[X_AMZ_USER_AGENT] = headers[X_AMZ_USER_AGENT]\n                ? `${headers[USER_AGENT]} ${normalUAValue}`\n                : normalUAValue;\n        }\n        headers[USER_AGENT] = sdkUserAgentValue;\n    }\n    else {\n        headers[X_AMZ_USER_AGENT] = sdkUserAgentValue;\n    }\n    return next({\n        ...args,\n        request,\n    });\n};\nconst escapeUserAgent = ([name, version]) => {\n    const prefixSeparatorIndex = name.indexOf(\"/\");\n    const prefix = name.substring(0, prefixSeparatorIndex);\n    let uaName = name.substring(prefixSeparatorIndex + 1);\n    if (prefix === \"api\") {\n        uaName = uaName.toLowerCase();\n    }\n    return [prefix, uaName, version]\n        .filter((item) => item && item.length > 0)\n        .map((item) => item?.replace(UA_ESCAPE_REGEX, \"_\"))\n        .join(\"/\");\n};\nexport const getUserAgentMiddlewareOptions = {\n    name: \"getUserAgentMiddleware\",\n    step: \"build\",\n    priority: \"low\",\n    tags: [\"SET_USER_AGENT\", \"USER_AGENT\"],\n    override: true,\n};\nexport const getUserAgentPlugin = (config) => ({\n    applyToStack: (clientStack) => {\n        clientStack.add(userAgentMiddleware(config), getUserAgentMiddlewareOptions);\n    },\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}