{"ast":null,"code":"import _regeneratorRuntime from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectWithoutProperties from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nimport _classCallCheck from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _get from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nvar _excluded = [\"rateLimiter\"];\nimport { DefaultRateLimiter, RETRY_MODES } from \"@aws-sdk/util-retry\";\nimport { StandardRetryStrategy } from \"./StandardRetryStrategy\";\nexport var AdaptiveRetryStrategy = /*#__PURE__*/function (_StandardRetryStrateg) {\n  _inherits(AdaptiveRetryStrategy, _StandardRetryStrateg);\n  var _super = _createSuper(AdaptiveRetryStrategy);\n  function AdaptiveRetryStrategy(maxAttemptsProvider, options) {\n    var _this;\n    _classCallCheck(this, AdaptiveRetryStrategy);\n    var _ref = options !== null && options !== void 0 ? options : {},\n      rateLimiter = _ref.rateLimiter,\n      superOptions = _objectWithoutProperties(_ref, _excluded);\n    _this = _super.call(this, maxAttemptsProvider, superOptions);\n    _this.rateLimiter = rateLimiter !== null && rateLimiter !== void 0 ? rateLimiter : new DefaultRateLimiter();\n    _this.mode = RETRY_MODES.ADAPTIVE;\n    return _this;\n  }\n  _createClass(AdaptiveRetryStrategy, [{\n    key: \"retry\",\n    value: function () {\n      var _retry = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(next, args) {\n        var _this2 = this;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              return _context2.abrupt(\"return\", _get(_getPrototypeOf(AdaptiveRetryStrategy.prototype), \"retry\", this).call(this, next, args, {\n                beforeRequest: function () {\n                  var _beforeRequest = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n                    return _regeneratorRuntime().wrap(function _callee$(_context) {\n                      while (1) switch (_context.prev = _context.next) {\n                        case 0:\n                          return _context.abrupt(\"return\", _this2.rateLimiter.getSendToken());\n                        case 1:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }, _callee);\n                  }));\n                  function beforeRequest() {\n                    return _beforeRequest.apply(this, arguments);\n                  }\n                  return beforeRequest;\n                }(),\n                afterRequest: function afterRequest(response) {\n                  _this2.rateLimiter.updateClientSendingRate(response);\n                }\n              }));\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function retry(_x, _x2) {\n        return _retry.apply(this, arguments);\n      }\n      return retry;\n    }()\n  }]);\n  return AdaptiveRetryStrategy;\n}(StandardRetryStrategy);","map":{"version":3,"names":["DefaultRateLimiter","RETRY_MODES","StandardRetryStrategy","AdaptiveRetryStrategy","_StandardRetryStrateg","_inherits","_super","_createSuper","maxAttemptsProvider","options","_this","_classCallCheck","_ref","rateLimiter","superOptions","_objectWithoutProperties","_excluded","call","mode","ADAPTIVE","_createClass","key","value","_retry","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","next","args","_this2","wrap","_callee2$","_context2","prev","abrupt","_get","_getPrototypeOf","prototype","beforeRequest","_beforeRequest","_callee","_callee$","_context","getSendToken","stop","apply","arguments","afterRequest","response","updateClientSendingRate","retry","_x","_x2"],"sources":["/Users/ericli/Desktop/pill2/node_modules/@aws-sdk/client-s3/node_modules/@aws-sdk/middleware-retry/dist-es/AdaptiveRetryStrategy.js"],"sourcesContent":["import { DefaultRateLimiter, RETRY_MODES } from \"@aws-sdk/util-retry\";\nimport { StandardRetryStrategy } from \"./StandardRetryStrategy\";\nexport class AdaptiveRetryStrategy extends StandardRetryStrategy {\n    constructor(maxAttemptsProvider, options) {\n        const { rateLimiter, ...superOptions } = options ?? {};\n        super(maxAttemptsProvider, superOptions);\n        this.rateLimiter = rateLimiter ?? new DefaultRateLimiter();\n        this.mode = RETRY_MODES.ADAPTIVE;\n    }\n    async retry(next, args) {\n        return super.retry(next, args, {\n            beforeRequest: async () => {\n                return this.rateLimiter.getSendToken();\n            },\n            afterRequest: (response) => {\n                this.rateLimiter.updateClientSendingRate(response);\n            },\n        });\n    }\n}\n"],"mappings":";;;;;;;;;;AAAA,SAASA,kBAAkB,EAAEC,WAAW,QAAQ,qBAAqB;AACrE,SAASC,qBAAqB,QAAQ,yBAAyB;AAC/D,WAAaC,qBAAqB,0BAAAC,qBAAA;EAAAC,SAAA,CAAAF,qBAAA,EAAAC,qBAAA;EAAA,IAAAE,MAAA,GAAAC,YAAA,CAAAJ,qBAAA;EAC9B,SAAAA,sBAAYK,mBAAmB,EAAEC,OAAO,EAAE;IAAA,IAAAC,KAAA;IAAAC,eAAA,OAAAR,qBAAA;IACtC,IAAAS,IAAA,GAAyCH,OAAO,aAAPA,OAAO,cAAPA,OAAO,GAAI,CAAC,CAAC;MAA9CI,WAAW,GAAAD,IAAA,CAAXC,WAAW;MAAKC,YAAY,GAAAC,wBAAA,CAAAH,IAAA,EAAAI,SAAA;IACpCN,KAAA,GAAAJ,MAAA,CAAAW,IAAA,OAAMT,mBAAmB,EAAEM,YAAY;IACvCJ,KAAA,CAAKG,WAAW,GAAGA,WAAW,aAAXA,WAAW,cAAXA,WAAW,GAAI,IAAIb,kBAAkB,EAAE;IAC1DU,KAAA,CAAKQ,IAAI,GAAGjB,WAAW,CAACkB,QAAQ;IAAC,OAAAT,KAAA;EACrC;EAACU,YAAA,CAAAjB,qBAAA;IAAAkB,GAAA;IAAAC,KAAA;MAAA,IAAAC,MAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CACD,SAAAC,SAAYC,IAAI,EAAEC,IAAI;QAAA,IAAAC,MAAA;QAAA,OAAAL,mBAAA,GAAAM,IAAA,UAAAC,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAC,IAAA,GAAAD,SAAA,CAAAL,IAAA;YAAA;cAAA,OAAAK,SAAA,CAAAE,MAAA,WAAAC,IAAA,CAAAC,eAAA,CAAAlC,qBAAA,CAAAmC,SAAA,kBAAArB,IAAA,OACCW,IAAI,EAAEC,IAAI,EAAE;gBAC3BU,aAAa;kBAAA,IAAAC,cAAA,GAAAhB,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAE,SAAAe,QAAA;oBAAA,OAAAhB,mBAAA,GAAAM,IAAA,UAAAW,SAAAC,QAAA;sBAAA,kBAAAA,QAAA,CAAAT,IAAA,GAAAS,QAAA,CAAAf,IAAA;wBAAA;0BAAA,OAAAe,QAAA,CAAAR,MAAA,WACJL,MAAI,CAACjB,WAAW,CAAC+B,YAAY,EAAE;wBAAA;wBAAA;0BAAA,OAAAD,QAAA,CAAAE,IAAA;sBAAA;oBAAA,GAAAJ,OAAA;kBAAA,CACzC;kBAAA,SAAAF,cAAA;oBAAA,OAAAC,cAAA,CAAAM,KAAA,OAAAC,SAAA;kBAAA;kBAAA,OAAAR,aAAA;gBAAA;gBACDS,YAAY,EAAE,SAAAA,aAACC,QAAQ,EAAK;kBACxBnB,MAAI,CAACjB,WAAW,CAACqC,uBAAuB,CAACD,QAAQ,CAAC;gBACtD;cACJ,CAAC;YAAA;YAAA;cAAA,OAAAhB,SAAA,CAAAY,IAAA;UAAA;QAAA,GAAAlB,QAAA;MAAA,CACJ;MAAA,SAAAwB,MAAAC,EAAA,EAAAC,GAAA;QAAA,OAAA9B,MAAA,CAAAuB,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAAI,KAAA;IAAA;EAAA;EAAA,OAAAhD,qBAAA;AAAA,EAhBsCD,qBAAqB"},"metadata":{},"sourceType":"module","externalDependencies":[]}