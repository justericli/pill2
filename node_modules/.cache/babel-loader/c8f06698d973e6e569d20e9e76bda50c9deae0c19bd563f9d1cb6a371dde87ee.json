{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _slicedToArray from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { debugId, toDebugString } from \"./debug\";\nimport { EndpointError } from \"./types\";\nimport { evaluateRules } from \"./utils\";\nexport var resolveEndpoint = function resolveEndpoint(ruleSetObject, options) {\n  var _options$logger, _options$logger$debug, _options$endpointPara, _options$logger2, _options$logger2$debu;\n  var endpointParams = options.endpointParams,\n    logger = options.logger;\n  var parameters = ruleSetObject.parameters,\n    rules = ruleSetObject.rules;\n  (_options$logger = options.logger) === null || _options$logger === void 0 ? void 0 : (_options$logger$debug = _options$logger.debug) === null || _options$logger$debug === void 0 ? void 0 : _options$logger$debug.call(_options$logger, \"\".concat(debugId, \" Initial EndpointParams: \").concat(toDebugString(endpointParams)));\n  var paramsWithDefault = Object.entries(parameters).filter(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n      v = _ref2[1];\n    return v.default != null;\n  }).map(function (_ref3) {\n    var _ref4 = _slicedToArray(_ref3, 2),\n      k = _ref4[0],\n      v = _ref4[1];\n    return [k, v.default];\n  });\n  if (paramsWithDefault.length > 0) {\n    var _iterator = _createForOfIteratorHelper(paramsWithDefault),\n      _step;\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var _endpointParams$param;\n        var _step$value = _slicedToArray(_step.value, 2),\n          paramKey = _step$value[0],\n          paramDefaultValue = _step$value[1];\n        endpointParams[paramKey] = (_endpointParams$param = endpointParams[paramKey]) !== null && _endpointParams$param !== void 0 ? _endpointParams$param : paramDefaultValue;\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  }\n  var requiredParams = Object.entries(parameters).filter(function (_ref5) {\n    var _ref6 = _slicedToArray(_ref5, 2),\n      v = _ref6[1];\n    return v.required;\n  }).map(function (_ref7) {\n    var _ref8 = _slicedToArray(_ref7, 1),\n      k = _ref8[0];\n    return k;\n  });\n  var _iterator2 = _createForOfIteratorHelper(requiredParams),\n    _step2;\n  try {\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n      var requiredParam = _step2.value;\n      if (endpointParams[requiredParam] == null) {\n        throw new EndpointError(\"Missing required parameter: '\".concat(requiredParam, \"'\"));\n      }\n    }\n  } catch (err) {\n    _iterator2.e(err);\n  } finally {\n    _iterator2.f();\n  }\n  var endpoint = evaluateRules(rules, {\n    endpointParams: endpointParams,\n    logger: logger,\n    referenceRecord: {}\n  });\n  if ((_options$endpointPara = options.endpointParams) !== null && _options$endpointPara !== void 0 && _options$endpointPara.Endpoint) {\n    try {\n      var givenEndpoint = new URL(options.endpointParams.Endpoint);\n      var protocol = givenEndpoint.protocol,\n        port = givenEndpoint.port;\n      endpoint.url.protocol = protocol;\n      endpoint.url.port = port;\n    } catch (e) {}\n  }\n  (_options$logger2 = options.logger) === null || _options$logger2 === void 0 ? void 0 : (_options$logger2$debu = _options$logger2.debug) === null || _options$logger2$debu === void 0 ? void 0 : _options$logger2$debu.call(_options$logger2, \"\".concat(debugId, \" Resolved endpoint: \").concat(toDebugString(endpoint)));\n  return endpoint;\n};","map":{"version":3,"names":["debugId","toDebugString","EndpointError","evaluateRules","resolveEndpoint","ruleSetObject","options","_options$logger","_options$logger$debug","_options$endpointPara","_options$logger2","_options$logger2$debu","endpointParams","logger","parameters","rules","debug","call","concat","paramsWithDefault","Object","entries","filter","_ref","_ref2","_slicedToArray","v","default","map","_ref3","_ref4","k","length","_iterator","_createForOfIteratorHelper","_step","s","n","done","_endpointParams$param","_step$value","value","paramKey","paramDefaultValue","err","e","f","requiredParams","_ref5","_ref6","required","_ref7","_ref8","_iterator2","_step2","requiredParam","endpoint","referenceRecord","Endpoint","givenEndpoint","URL","protocol","port","url"],"sources":["/Users/ericli/Desktop/pill2/node_modules/@aws-sdk/util-endpoints/dist-es/resolveEndpoint.js"],"sourcesContent":["import { debugId, toDebugString } from \"./debug\";\nimport { EndpointError } from \"./types\";\nimport { evaluateRules } from \"./utils\";\nexport const resolveEndpoint = (ruleSetObject, options) => {\n    const { endpointParams, logger } = options;\n    const { parameters, rules } = ruleSetObject;\n    options.logger?.debug?.(`${debugId} Initial EndpointParams: ${toDebugString(endpointParams)}`);\n    const paramsWithDefault = Object.entries(parameters)\n        .filter(([, v]) => v.default != null)\n        .map(([k, v]) => [k, v.default]);\n    if (paramsWithDefault.length > 0) {\n        for (const [paramKey, paramDefaultValue] of paramsWithDefault) {\n            endpointParams[paramKey] = endpointParams[paramKey] ?? paramDefaultValue;\n        }\n    }\n    const requiredParams = Object.entries(parameters)\n        .filter(([, v]) => v.required)\n        .map(([k]) => k);\n    for (const requiredParam of requiredParams) {\n        if (endpointParams[requiredParam] == null) {\n            throw new EndpointError(`Missing required parameter: '${requiredParam}'`);\n        }\n    }\n    const endpoint = evaluateRules(rules, { endpointParams, logger, referenceRecord: {} });\n    if (options.endpointParams?.Endpoint) {\n        try {\n            const givenEndpoint = new URL(options.endpointParams.Endpoint);\n            const { protocol, port } = givenEndpoint;\n            endpoint.url.protocol = protocol;\n            endpoint.url.port = port;\n        }\n        catch (e) {\n        }\n    }\n    options.logger?.debug?.(`${debugId} Resolved endpoint: ${toDebugString(endpoint)}`);\n    return endpoint;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}