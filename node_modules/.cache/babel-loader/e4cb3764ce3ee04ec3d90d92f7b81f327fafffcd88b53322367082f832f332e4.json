{"ast":null,"code":"var _jsxFileName = \"/Users/ericli/Desktop/pill2/src/components/User_dashboard.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport UserPool from \"../User_Userpool.jsx\"; // adjust the import path to where your User_Userpool.jsx file is located\nimport FacebookLogin from \"facebook-login\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst User_dashboard = () => {\n  _s();\n  const [givenName, setGivenName] = useState(\"\");\n  useEffect(() => {\n    const cognitoUser = UserPool.getCurrentUser();\n    if (cognitoUser != null) {\n      cognitoUser.getSession((err, session) => {\n        if (err) {\n          alert(err);\n          return;\n        }\n        console.log(\"session validity: \" + session.isValid());\n        setGivenName(session.getIdToken().payload[\"given_name\"]);\n      });\n    }\n  }, []);\n  useEffect(() => {\n    const fbLogin = new FacebookLogin();\n    fbLogin.init({\n      appId: \"730655258288890\",\n      cookie: true,\n      xfbml: true,\n      version: \"v15.0\"\n    });\n    fbLogin.on(\"success\", response => {\n      console.log(\"User logged in with Facebook\");\n      getUserInfo();\n    });\n    return () => {\n      fbLogin.logout();\n    };\n  }, []);\n  const getUserInfo = () => {\n    console.log(\"Getting user info\");\n    window.FB.api(\"/me\", {\n      fields: \"name,email\",\n      appsecret_proof: process.env.PASS_PHRASE\n    }, response => {\n      console.log(\"User info response:\", response);\n      console.log(\"Successful login for: \" + response.name);\n      const authResponse = window.FB.getAuthResponse();\n      let {\n        accessToken,\n        expiresIn\n      } = authResponse;\n      if (!accessToken || !expiresIn) {\n        console.log(\"Access token or expiration time is missing.\");\n        return;\n      }\n      document.getElementById(\"status\").innerHTML = \"Thanks for logging in, \" + response.name + \"!\";\n      console.log(\"Facebook Access Token: \", accessToken);\n      const {\n        email,\n        name\n      } = response;\n\n      // Update the user's email and name attributes\n      Auth.updateUserAttributes(authenticate().user, {\n        email,\n        name\n      });\n\n      // Redirect the user to the dashboard\n      navigate(\"/User_dashboard\");\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"User Dashboard\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Thanks for logging in, \", givenName]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 5\n  }, this);\n};\n_s(User_dashboard, \"+Dm7cY+Wa4d/PS29WRSEKG6GPXQ=\");\n_c = User_dashboard;\nexport default User_dashboard;\nvar _c;\n$RefreshReg$(_c, \"User_dashboard\");","map":{"version":3,"names":["React","useState","useEffect","UserPool","FacebookLogin","jsxDEV","_jsxDEV","User_dashboard","_s","givenName","setGivenName","cognitoUser","getCurrentUser","getSession","err","session","alert","console","log","isValid","getIdToken","payload","fbLogin","init","appId","cookie","xfbml","version","on","response","getUserInfo","logout","window","FB","api","fields","appsecret_proof","process","env","PASS_PHRASE","name","authResponse","getAuthResponse","accessToken","expiresIn","document","getElementById","innerHTML","email","Auth","updateUserAttributes","authenticate","user","navigate","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/ericli/Desktop/pill2/src/components/User_dashboard.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport UserPool from \"../User_Userpool.jsx\"; // adjust the import path to where your User_Userpool.jsx file is located\nimport FacebookLogin from \"facebook-login\";\n\nconst User_dashboard = () => {\n  const [givenName, setGivenName] = useState(\"\");\n\n  useEffect(() => {\n    const cognitoUser = UserPool.getCurrentUser();\n    if (cognitoUser != null) {\n      cognitoUser.getSession((err, session) => {\n        if (err) {\n          alert(err);\n          return;\n        }\n\n        console.log(\"session validity: \" + session.isValid());\n        setGivenName(session.getIdToken().payload[\"given_name\"]);\n      });\n    }\n  }, []);\n\n  useEffect(() => {\n    const fbLogin = new FacebookLogin();\n    fbLogin.init({\n      appId: \"730655258288890\",\n      cookie: true,\n      xfbml: true,\n      version: \"v15.0\",\n    });\n    fbLogin.on(\"success\", (response) => {\n      console.log(\"User logged in with Facebook\");\n      getUserInfo();\n    });\n\n    return () => {\n      fbLogin.logout();\n    };\n  }, []);\n\n  const getUserInfo = () => {\n    console.log(\"Getting user info\");\n    window.FB.api(\n      \"/me\",\n      {\n        fields: \"name,email\",\n        appsecret_proof: process.env.PASS_PHRASE,\n      },\n      (response) => {\n        console.log(\"User info response:\", response);\n        console.log(\"Successful login for: \" + response.name);\n\n        const authResponse = window.FB.getAuthResponse();\n        let { accessToken, expiresIn } = authResponse;\n\n        if (!accessToken || !expiresIn) {\n          console.log(\"Access token or expiration time is missing.\");\n          return;\n        }\n\n        document.getElementById(\"status\").innerHTML =\n          \"Thanks for logging in, \" + response.name + \"!\";\n\n        console.log(\"Facebook Access Token: \", accessToken);\n\n        const { email, name } = response;\n\n        // Update the user's email and name attributes\n        Auth.updateUserAttributes(authenticate().user, {\n          email,\n          name,\n        });\n\n        // Redirect the user to the dashboard\n        navigate(\"/User_dashboard\");\n      }\n    );\n  };\n\n  return (\n    <div>\n      <h1>User Dashboard</h1>\n      <p>Thanks for logging in, {givenName}</p>\n    </div>\n  );\n};\n\nexport default User_dashboard;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}