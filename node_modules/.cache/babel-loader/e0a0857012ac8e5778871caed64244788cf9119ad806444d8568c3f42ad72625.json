{"ast":null,"code":"import { debugId, toDebugString } from \"./debug\";\nimport { EndpointError } from \"./types\";\nimport { evaluateRules } from \"./utils\";\nexport const resolveEndpoint = (ruleSetObject, options) => {\n  const {\n    endpointParams,\n    logger\n  } = options;\n  const {\n    parameters,\n    rules\n  } = ruleSetObject;\n  options.logger?.debug?.(`${debugId} Initial EndpointParams: ${toDebugString(endpointParams)}`);\n  const paramsWithDefault = Object.entries(parameters).filter(_ref => {\n    let [, v] = _ref;\n    return v.default != null;\n  }).map(_ref2 => {\n    let [k, v] = _ref2;\n    return [k, v.default];\n  });\n  if (paramsWithDefault.length > 0) {\n    for (const [paramKey, paramDefaultValue] of paramsWithDefault) {\n      endpointParams[paramKey] = endpointParams[paramKey] ?? paramDefaultValue;\n    }\n  }\n  const requiredParams = Object.entries(parameters).filter(_ref3 => {\n    let [, v] = _ref3;\n    return v.required;\n  }).map(_ref4 => {\n    let [k] = _ref4;\n    return k;\n  });\n  for (const requiredParam of requiredParams) {\n    if (endpointParams[requiredParam] == null) {\n      throw new EndpointError(`Missing required parameter: '${requiredParam}'`);\n    }\n  }\n  const endpoint = evaluateRules(rules, {\n    endpointParams,\n    logger,\n    referenceRecord: {}\n  });\n  if (options.endpointParams?.Endpoint) {\n    try {\n      const givenEndpoint = new URL(options.endpointParams.Endpoint);\n      const {\n        protocol,\n        port\n      } = givenEndpoint;\n      endpoint.url.protocol = protocol;\n      endpoint.url.port = port;\n    } catch (e) {}\n  }\n  options.logger?.debug?.(`${debugId} Resolved endpoint: ${toDebugString(endpoint)}`);\n  return endpoint;\n};","map":{"version":3,"names":["debugId","toDebugString","EndpointError","evaluateRules","resolveEndpoint","ruleSetObject","options","endpointParams","logger","parameters","rules","debug","paramsWithDefault","Object","entries","filter","_ref","v","default","map","_ref2","k","length","paramKey","paramDefaultValue","requiredParams","_ref3","required","_ref4","requiredParam","endpoint","referenceRecord","Endpoint","givenEndpoint","URL","protocol","port","url","e"],"sources":["/Users/ericli/Desktop/pill2/node_modules/@aws-sdk/util-endpoints/dist-es/resolveEndpoint.js"],"sourcesContent":["import { debugId, toDebugString } from \"./debug\";\nimport { EndpointError } from \"./types\";\nimport { evaluateRules } from \"./utils\";\nexport const resolveEndpoint = (ruleSetObject, options) => {\n    const { endpointParams, logger } = options;\n    const { parameters, rules } = ruleSetObject;\n    options.logger?.debug?.(`${debugId} Initial EndpointParams: ${toDebugString(endpointParams)}`);\n    const paramsWithDefault = Object.entries(parameters)\n        .filter(([, v]) => v.default != null)\n        .map(([k, v]) => [k, v.default]);\n    if (paramsWithDefault.length > 0) {\n        for (const [paramKey, paramDefaultValue] of paramsWithDefault) {\n            endpointParams[paramKey] = endpointParams[paramKey] ?? paramDefaultValue;\n        }\n    }\n    const requiredParams = Object.entries(parameters)\n        .filter(([, v]) => v.required)\n        .map(([k]) => k);\n    for (const requiredParam of requiredParams) {\n        if (endpointParams[requiredParam] == null) {\n            throw new EndpointError(`Missing required parameter: '${requiredParam}'`);\n        }\n    }\n    const endpoint = evaluateRules(rules, { endpointParams, logger, referenceRecord: {} });\n    if (options.endpointParams?.Endpoint) {\n        try {\n            const givenEndpoint = new URL(options.endpointParams.Endpoint);\n            const { protocol, port } = givenEndpoint;\n            endpoint.url.protocol = protocol;\n            endpoint.url.port = port;\n        }\n        catch (e) {\n        }\n    }\n    options.logger?.debug?.(`${debugId} Resolved endpoint: ${toDebugString(endpoint)}`);\n    return endpoint;\n};\n"],"mappings":"AAAA,SAASA,OAAO,EAAEC,aAAa,QAAQ,SAAS;AAChD,SAASC,aAAa,QAAQ,SAAS;AACvC,SAASC,aAAa,QAAQ,SAAS;AACvC,OAAO,MAAMC,eAAe,GAAGA,CAACC,aAAa,EAAEC,OAAO,KAAK;EACvD,MAAM;IAAEC,cAAc;IAAEC;EAAO,CAAC,GAAGF,OAAO;EAC1C,MAAM;IAAEG,UAAU;IAAEC;EAAM,CAAC,GAAGL,aAAa;EAC3CC,OAAO,CAACE,MAAM,EAAEG,KAAK,GAAI,GAAEX,OAAQ,4BAA2BC,aAAa,CAACM,cAAc,CAAE,EAAC,CAAC;EAC9F,MAAMK,iBAAiB,GAAGC,MAAM,CAACC,OAAO,CAACL,UAAU,CAAC,CAC/CM,MAAM,CAACC,IAAA;IAAA,IAAC,GAAGC,CAAC,CAAC,GAAAD,IAAA;IAAA,OAAKC,CAAC,CAACC,OAAO,IAAI,IAAI;EAAA,EAAC,CACpCC,GAAG,CAACC,KAAA;IAAA,IAAC,CAACC,CAAC,EAAEJ,CAAC,CAAC,GAAAG,KAAA;IAAA,OAAK,CAACC,CAAC,EAAEJ,CAAC,CAACC,OAAO,CAAC;EAAA,EAAC;EACpC,IAAIN,iBAAiB,CAACU,MAAM,GAAG,CAAC,EAAE;IAC9B,KAAK,MAAM,CAACC,QAAQ,EAAEC,iBAAiB,CAAC,IAAIZ,iBAAiB,EAAE;MAC3DL,cAAc,CAACgB,QAAQ,CAAC,GAAGhB,cAAc,CAACgB,QAAQ,CAAC,IAAIC,iBAAiB;IAC5E;EACJ;EACA,MAAMC,cAAc,GAAGZ,MAAM,CAACC,OAAO,CAACL,UAAU,CAAC,CAC5CM,MAAM,CAACW,KAAA;IAAA,IAAC,GAAGT,CAAC,CAAC,GAAAS,KAAA;IAAA,OAAKT,CAAC,CAACU,QAAQ;EAAA,EAAC,CAC7BR,GAAG,CAACS,KAAA;IAAA,IAAC,CAACP,CAAC,CAAC,GAAAO,KAAA;IAAA,OAAKP,CAAC;EAAA,EAAC;EACpB,KAAK,MAAMQ,aAAa,IAAIJ,cAAc,EAAE;IACxC,IAAIlB,cAAc,CAACsB,aAAa,CAAC,IAAI,IAAI,EAAE;MACvC,MAAM,IAAI3B,aAAa,CAAE,gCAA+B2B,aAAc,GAAE,CAAC;IAC7E;EACJ;EACA,MAAMC,QAAQ,GAAG3B,aAAa,CAACO,KAAK,EAAE;IAAEH,cAAc;IAAEC,MAAM;IAAEuB,eAAe,EAAE,CAAC;EAAE,CAAC,CAAC;EACtF,IAAIzB,OAAO,CAACC,cAAc,EAAEyB,QAAQ,EAAE;IAClC,IAAI;MACA,MAAMC,aAAa,GAAG,IAAIC,GAAG,CAAC5B,OAAO,CAACC,cAAc,CAACyB,QAAQ,CAAC;MAC9D,MAAM;QAAEG,QAAQ;QAAEC;MAAK,CAAC,GAAGH,aAAa;MACxCH,QAAQ,CAACO,GAAG,CAACF,QAAQ,GAAGA,QAAQ;MAChCL,QAAQ,CAACO,GAAG,CAACD,IAAI,GAAGA,IAAI;IAC5B,CAAC,CACD,OAAOE,CAAC,EAAE,CACV;EACJ;EACAhC,OAAO,CAACE,MAAM,EAAEG,KAAK,GAAI,GAAEX,OAAQ,uBAAsBC,aAAa,CAAC6B,QAAQ,CAAE,EAAC,CAAC;EACnF,OAAOA,QAAQ;AACnB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}