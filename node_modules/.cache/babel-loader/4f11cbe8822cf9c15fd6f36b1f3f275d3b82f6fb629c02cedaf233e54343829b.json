{"ast":null,"code":"import _regeneratorRuntime from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _objectSpread from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"/Users/ericli/Desktop/pill2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { HttpRequest } from \"@aws-sdk/protocol-http\";\nvar TRACE_ID_HEADER_NAME = \"X-Amzn-Trace-Id\";\nvar ENV_LAMBDA_FUNCTION_NAME = \"AWS_LAMBDA_FUNCTION_NAME\";\nvar ENV_TRACE_ID = \"_X_AMZN_TRACE_ID\";\nexport var recursionDetectionMiddleware = function recursionDetectionMiddleware(options) {\n  return function (next) {\n    return /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(args) {\n        var request, functionName, traceId, nonEmptyString;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              request = args.request;\n              if (!(!HttpRequest.isInstance(request) || options.runtime !== \"node\" || request.headers.hasOwnProperty(TRACE_ID_HEADER_NAME))) {\n                _context.next = 3;\n                break;\n              }\n              return _context.abrupt(\"return\", next(args));\n            case 3:\n              functionName = process.env[ENV_LAMBDA_FUNCTION_NAME];\n              traceId = process.env[ENV_TRACE_ID];\n              nonEmptyString = function nonEmptyString(str) {\n                return typeof str === \"string\" && str.length > 0;\n              };\n              if (nonEmptyString(functionName) && nonEmptyString(traceId)) {\n                request.headers[TRACE_ID_HEADER_NAME] = traceId;\n              }\n              return _context.abrupt(\"return\", next(_objectSpread(_objectSpread({}, args), {}, {\n                request: request\n              })));\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n  };\n};\nexport var addRecursionDetectionMiddlewareOptions = {\n  step: \"build\",\n  tags: [\"RECURSION_DETECTION\"],\n  name: \"recursionDetectionMiddleware\",\n  override: true,\n  priority: \"low\"\n};\nexport var getRecursionDetectionPlugin = function getRecursionDetectionPlugin(options) {\n  return {\n    applyToStack: function applyToStack(clientStack) {\n      clientStack.add(recursionDetectionMiddleware(options), addRecursionDetectionMiddlewareOptions);\n    }\n  };\n};","map":{"version":3,"names":["HttpRequest","TRACE_ID_HEADER_NAME","ENV_LAMBDA_FUNCTION_NAME","ENV_TRACE_ID","recursionDetectionMiddleware","options","next","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","args","request","functionName","traceId","nonEmptyString","wrap","_callee$","_context","prev","isInstance","runtime","headers","hasOwnProperty","abrupt","process","env","str","length","_objectSpread","stop","_x","apply","arguments","addRecursionDetectionMiddlewareOptions","step","tags","name","override","priority","getRecursionDetectionPlugin","applyToStack","clientStack","add"],"sources":["/Users/ericli/Desktop/pill2/node_modules/@aws-sdk/client-s3/node_modules/@aws-sdk/middleware-recursion-detection/dist-es/index.js"],"sourcesContent":["import { HttpRequest } from \"@aws-sdk/protocol-http\";\nconst TRACE_ID_HEADER_NAME = \"X-Amzn-Trace-Id\";\nconst ENV_LAMBDA_FUNCTION_NAME = \"AWS_LAMBDA_FUNCTION_NAME\";\nconst ENV_TRACE_ID = \"_X_AMZN_TRACE_ID\";\nexport const recursionDetectionMiddleware = (options) => (next) => async (args) => {\n    const { request } = args;\n    if (!HttpRequest.isInstance(request) ||\n        options.runtime !== \"node\" ||\n        request.headers.hasOwnProperty(TRACE_ID_HEADER_NAME)) {\n        return next(args);\n    }\n    const functionName = process.env[ENV_LAMBDA_FUNCTION_NAME];\n    const traceId = process.env[ENV_TRACE_ID];\n    const nonEmptyString = (str) => typeof str === \"string\" && str.length > 0;\n    if (nonEmptyString(functionName) && nonEmptyString(traceId)) {\n        request.headers[TRACE_ID_HEADER_NAME] = traceId;\n    }\n    return next({\n        ...args,\n        request,\n    });\n};\nexport const addRecursionDetectionMiddlewareOptions = {\n    step: \"build\",\n    tags: [\"RECURSION_DETECTION\"],\n    name: \"recursionDetectionMiddleware\",\n    override: true,\n    priority: \"low\",\n};\nexport const getRecursionDetectionPlugin = (options) => ({\n    applyToStack: (clientStack) => {\n        clientStack.add(recursionDetectionMiddleware(options), addRecursionDetectionMiddlewareOptions);\n    },\n});\n"],"mappings":";;;AAAA,SAASA,WAAW,QAAQ,wBAAwB;AACpD,IAAMC,oBAAoB,GAAG,iBAAiB;AAC9C,IAAMC,wBAAwB,GAAG,0BAA0B;AAC3D,IAAMC,YAAY,GAAG,kBAAkB;AACvC,OAAO,IAAMC,4BAA4B,GAAG,SAA/BA,4BAA4BA,CAAIC,OAAO;EAAA,OAAK,UAACC,IAAI;IAAA;MAAA,IAAAC,IAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAK,SAAAC,QAAOC,IAAI;QAAA,IAAAC,OAAA,EAAAC,YAAA,EAAAC,OAAA,EAAAC,cAAA;QAAA,OAAAP,mBAAA,GAAAQ,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAb,IAAA;YAAA;cAClEO,OAAO,GAAKD,IAAI,CAAhBC,OAAO;cAAA,MACX,CAACb,WAAW,CAACqB,UAAU,CAACR,OAAO,CAAC,IAChCR,OAAO,CAACiB,OAAO,KAAK,MAAM,IAC1BT,OAAO,CAACU,OAAO,CAACC,cAAc,CAACvB,oBAAoB,CAAC;gBAAAkB,QAAA,CAAAb,IAAA;gBAAA;cAAA;cAAA,OAAAa,QAAA,CAAAM,MAAA,WAC7CnB,IAAI,CAACM,IAAI,CAAC;YAAA;cAEfE,YAAY,GAAGY,OAAO,CAACC,GAAG,CAACzB,wBAAwB,CAAC;cACpDa,OAAO,GAAGW,OAAO,CAACC,GAAG,CAACxB,YAAY,CAAC;cACnCa,cAAc,GAAG,SAAjBA,cAAcA,CAAIY,GAAG;gBAAA,OAAK,OAAOA,GAAG,KAAK,QAAQ,IAAIA,GAAG,CAACC,MAAM,GAAG,CAAC;cAAA;cACzE,IAAIb,cAAc,CAACF,YAAY,CAAC,IAAIE,cAAc,CAACD,OAAO,CAAC,EAAE;gBACzDF,OAAO,CAACU,OAAO,CAACtB,oBAAoB,CAAC,GAAGc,OAAO;cACnD;cAAC,OAAAI,QAAA,CAAAM,MAAA,WACMnB,IAAI,CAAAwB,aAAA,CAAAA,aAAA,KACJlB,IAAI;gBACPC,OAAO,EAAPA;cAAO,GACT;YAAA;YAAA;cAAA,OAAAM,QAAA,CAAAY,IAAA;UAAA;QAAA,GAAApB,OAAA;MAAA,CACL;MAAA,iBAAAqB,EAAA;QAAA,OAAAzB,IAAA,CAAA0B,KAAA,OAAAC,SAAA;MAAA;IAAA;EAAA;AAAA;AACD,OAAO,IAAMC,sCAAsC,GAAG;EAClDC,IAAI,EAAE,OAAO;EACbC,IAAI,EAAE,CAAC,qBAAqB,CAAC;EAC7BC,IAAI,EAAE,8BAA8B;EACpCC,QAAQ,EAAE,IAAI;EACdC,QAAQ,EAAE;AACd,CAAC;AACD,OAAO,IAAMC,2BAA2B,GAAG,SAA9BA,2BAA2BA,CAAIpC,OAAO;EAAA,OAAM;IACrDqC,YAAY,EAAE,SAAAA,aAACC,WAAW,EAAK;MAC3BA,WAAW,CAACC,GAAG,CAACxC,4BAA4B,CAACC,OAAO,CAAC,EAAE8B,sCAAsC,CAAC;IAClG;EACJ,CAAC;AAAA,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}