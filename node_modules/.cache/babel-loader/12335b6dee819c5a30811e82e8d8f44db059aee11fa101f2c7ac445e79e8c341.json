{"ast":null,"code":"import React, { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Auth } from \"aws-amplify\";\nimport FacebookLogin from \"facebook-login\";\n\n// const User_login = () => {\n//   const [email, setEmail] = useState(\"\");\n//   const [password, setPassword] = useState(\"\");\n//   const [fbLoaded, setFbLoaded] = useState(false);\n//   const navigate = useNavigate();\n//   const { authenticate, setAuthenticated } = useContext(AccountContext);\n\n//   const statusChangeCallback = (response) => {\n//     console.log(\"Status Change Callback Response:\", response);\n//     if (response.status === \"connected\") {\n//       getUserInfo();\n//     } else {\n//       console.log(\"User cancelled login or did not fully authorize.\");\n//       document.getElementById(\"status\").innerHTML =\n//         \"Please log into this webpage.\";\n//     }\n//   };\n\n//   const getUserInfo = () => {\n//     console.log(\"Getting user info\");\n//     window.FB.api(\n//       \"/me\",\n//       {\n//         fields: \"first_name,last_name,email\",\n//         appsecret_proof: process.env.PASS_PHRASE,\n//       },\n//       function (response) {\n//         console.log(\"User info response:\", response);\n//         console.log(\"Successful login for: \" + response.name);\n\n//         const authResponse = window.FB.getAuthResponse();\n//         let { accessToken, expiresIn } = authResponse;\n\n//         if (!accessToken || !expiresIn) {\n//           console.log(\"Access token or expiration time is missing.\");\n//           return;\n//         }\n\n//         document.getElementById(\"status\").innerHTML =\n//           \"Thanks for logging in, \" + response.name + \"!\";\n\n//         console.log(\"Facebook Access Token: \", accessToken);\n\n//         const { email, first_name, last_name, gender } = response;\n\n//         console.log(\n//           \"FACEBOOK_APP_SECRET: \",\n//           process.env.REACT_APP_FACEBOOK_APP_SECRET\n//         );\n\n//         window.FB.api(\n//           \"/oauth/access_token\",\n//           {\n//             client_id: \"730655258288890\",\n//             client_secret: process.env.REACT_APP_FACEBOOK_APP_SECRET,\n//             grant_type: \"fb_exchange_token\",\n//             fb_exchange_token: accessToken,\n//           },\n//           function (res) {\n//             if (!res || res.error) {\n//               console.log(\n//                 \"Failed to extend access token lifespan: \",\n//                 res.error\n//               );\n//             } else {\n//               accessToken = res.access_token;\n//               expiresIn = res.expires_in;\n\n//               const currentTimestamp = Date.now();\n//               const computedExpiresAt = expiresIn * 1000 + currentTimestamp;\n\n//               if (!accessToken || !computedExpiresAt) {\n//                 console.log(\n//                   \"Access token or computed expires time is missing.\"\n//                 );\n//                 return;\n//               }\n\n//               Auth.federatedSignIn(\n//                 \"facebook\",\n//                 {\n//                   token: accessToken,\n//                   expires_at: computedExpiresAt,\n//                 },\n//                 {\n//                   given_name: first_name,\n//                   family_name: last_name,\n//                   email: email,\n//                   gender: gender,\n//                   picture: \"\",\n//                   email_verified: true,\n//                 }\n//               )\n//                 .then((data) => {\n//                   console.log(\"Successful federated sign-in:\", data);\n//                   setAuthenticated(true);\n//                   navigate(\"/User_dashboard\");\n//                 })\n//                 .catch((err) => {\n//                   console.log(\n//                     \"Failed to login\",\n//                     err || \"No error message provided\"\n//                   );\n//                 });\n//             }\n//           }\n//         );\n//       }\n//     );\n//   };\n\n//   const checkLoginState = () => {\n//     console.log(\"Checking login state\");\n//     if (fbLoaded) {\n//       window.FB.getLoginStatus(function (response) {\n//         console.log(\"Got login status response\", response);\n//         statusChangeCallback(response);\n//       });\n//     } else {\n//       console.log(\"Facebook SDK not loaded yet\");\n//     }\n//   };\n\n//   useEffect(() => {\n//     if (window.FB) {\n//       setFbLoaded(true);\n//       window.FB.getLoginStatus(function (response) {\n//         statusChangeCallback(response);\n//       });\n//     } else {\n//       window.fbAsyncInit = function () {\n//         window.FB.init({\n//           appId: \"730655258288890\",\n//           cookie: true,\n//           xfbml: true,\n//           version: \"v15.0\",\n//         });\n\n//         window.FB.AppEvents.logPageView();\n\n//         window.FB.getLoginStatus(function (response) {\n//           statusChangeCallback(response);\n//         });\n\n//         setFbLoaded(true);\n//       };\n\n//       (function (d, s, id) {\n//         var js,\n//           fjs = d.getElementsByTagName(s)[0];\n//         if (d.getElementById(id)) return;\n//         js = d.createElement(s);\n//         js.id = id;\n//         js.src = \"https://connect.facebook.net/en_US/sdk.js\";\n//         fjs.parentNode.insertBefore(js, fjs);\n//       })(document, \"script\", \"facebook-jssdk\");\n//     }\n//   }, []);\n\n//   const onSubmit = (event) => {\n//     event.preventDefault();\n\n//     authenticate(email, password)\n//       .then((data) => {\n//         console.log(\"Works1234567890\");\n//         setAuthenticated(true);\n\n//         navigate(\"/User_dashboard\");\n//       })\n//       .catch((err) => {\n//         console.log(\"Failed to login\", err || \"No error message provided\");\n//       });\n//   };\n\n//   return (\n//     <div>\n//       <form onSubmit={onSubmit}>\n//         <label htmlFor=\"email\">Email</label>\n//         <input\n//           value={email}\n//           onChange={(event) => setEmail(event.target.value)}\n//         ></input>\n//         <label htmlFor=\"password\">Password</label>\n//         <input\n//           value={password}\n//           onChange={(event) => setPassword(event.target.value)}\n//         ></input>\n//         <button type=\"submit\">Login</button>\n//       </form>\n//       <div\n//         className=\"fb-login-button\"\n//         data-width=\"\"\n//         data-size=\"large\"\n//         data-button-type=\"continue_with\"\n//         data-layout=\"default\"\n//         data-auto-logout-link=\"false\"\n//         data-use-continue-as=\"true\"\n//       ></div>\n//       <button onClick={checkLoginState} disabled={!fbLoaded}>\n//         Hi\n//       </button>\n//     </div>\n//   );\n// };\n\n// export default User_login;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","Auth","FacebookLogin"],"sources":["/Users/ericli/Desktop/pill2/src/components/User_login.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Auth } from \"aws-amplify\";\nimport FacebookLogin from \"facebook-login\";\n\n// const User_login = () => {\n//   const [email, setEmail] = useState(\"\");\n//   const [password, setPassword] = useState(\"\");\n//   const [fbLoaded, setFbLoaded] = useState(false);\n//   const navigate = useNavigate();\n//   const { authenticate, setAuthenticated } = useContext(AccountContext);\n\n//   const statusChangeCallback = (response) => {\n//     console.log(\"Status Change Callback Response:\", response);\n//     if (response.status === \"connected\") {\n//       getUserInfo();\n//     } else {\n//       console.log(\"User cancelled login or did not fully authorize.\");\n//       document.getElementById(\"status\").innerHTML =\n//         \"Please log into this webpage.\";\n//     }\n//   };\n\n//   const getUserInfo = () => {\n//     console.log(\"Getting user info\");\n//     window.FB.api(\n//       \"/me\",\n//       {\n//         fields: \"first_name,last_name,email\",\n//         appsecret_proof: process.env.PASS_PHRASE,\n//       },\n//       function (response) {\n//         console.log(\"User info response:\", response);\n//         console.log(\"Successful login for: \" + response.name);\n\n//         const authResponse = window.FB.getAuthResponse();\n//         let { accessToken, expiresIn } = authResponse;\n\n//         if (!accessToken || !expiresIn) {\n//           console.log(\"Access token or expiration time is missing.\");\n//           return;\n//         }\n\n//         document.getElementById(\"status\").innerHTML =\n//           \"Thanks for logging in, \" + response.name + \"!\";\n\n//         console.log(\"Facebook Access Token: \", accessToken);\n\n//         const { email, first_name, last_name, gender } = response;\n\n//         console.log(\n//           \"FACEBOOK_APP_SECRET: \",\n//           process.env.REACT_APP_FACEBOOK_APP_SECRET\n//         );\n\n//         window.FB.api(\n//           \"/oauth/access_token\",\n//           {\n//             client_id: \"730655258288890\",\n//             client_secret: process.env.REACT_APP_FACEBOOK_APP_SECRET,\n//             grant_type: \"fb_exchange_token\",\n//             fb_exchange_token: accessToken,\n//           },\n//           function (res) {\n//             if (!res || res.error) {\n//               console.log(\n//                 \"Failed to extend access token lifespan: \",\n//                 res.error\n//               );\n//             } else {\n//               accessToken = res.access_token;\n//               expiresIn = res.expires_in;\n\n//               const currentTimestamp = Date.now();\n//               const computedExpiresAt = expiresIn * 1000 + currentTimestamp;\n\n//               if (!accessToken || !computedExpiresAt) {\n//                 console.log(\n//                   \"Access token or computed expires time is missing.\"\n//                 );\n//                 return;\n//               }\n\n//               Auth.federatedSignIn(\n//                 \"facebook\",\n//                 {\n//                   token: accessToken,\n//                   expires_at: computedExpiresAt,\n//                 },\n//                 {\n//                   given_name: first_name,\n//                   family_name: last_name,\n//                   email: email,\n//                   gender: gender,\n//                   picture: \"\",\n//                   email_verified: true,\n//                 }\n//               )\n//                 .then((data) => {\n//                   console.log(\"Successful federated sign-in:\", data);\n//                   setAuthenticated(true);\n//                   navigate(\"/User_dashboard\");\n//                 })\n//                 .catch((err) => {\n//                   console.log(\n//                     \"Failed to login\",\n//                     err || \"No error message provided\"\n//                   );\n//                 });\n//             }\n//           }\n//         );\n//       }\n//     );\n//   };\n\n//   const checkLoginState = () => {\n//     console.log(\"Checking login state\");\n//     if (fbLoaded) {\n//       window.FB.getLoginStatus(function (response) {\n//         console.log(\"Got login status response\", response);\n//         statusChangeCallback(response);\n//       });\n//     } else {\n//       console.log(\"Facebook SDK not loaded yet\");\n//     }\n//   };\n\n//   useEffect(() => {\n//     if (window.FB) {\n//       setFbLoaded(true);\n//       window.FB.getLoginStatus(function (response) {\n//         statusChangeCallback(response);\n//       });\n//     } else {\n//       window.fbAsyncInit = function () {\n//         window.FB.init({\n//           appId: \"730655258288890\",\n//           cookie: true,\n//           xfbml: true,\n//           version: \"v15.0\",\n//         });\n\n//         window.FB.AppEvents.logPageView();\n\n//         window.FB.getLoginStatus(function (response) {\n//           statusChangeCallback(response);\n//         });\n\n//         setFbLoaded(true);\n//       };\n\n//       (function (d, s, id) {\n//         var js,\n//           fjs = d.getElementsByTagName(s)[0];\n//         if (d.getElementById(id)) return;\n//         js = d.createElement(s);\n//         js.id = id;\n//         js.src = \"https://connect.facebook.net/en_US/sdk.js\";\n//         fjs.parentNode.insertBefore(js, fjs);\n//       })(document, \"script\", \"facebook-jssdk\");\n//     }\n//   }, []);\n\n//   const onSubmit = (event) => {\n//     event.preventDefault();\n\n//     authenticate(email, password)\n//       .then((data) => {\n//         console.log(\"Works1234567890\");\n//         setAuthenticated(true);\n\n//         navigate(\"/User_dashboard\");\n//       })\n//       .catch((err) => {\n//         console.log(\"Failed to login\", err || \"No error message provided\");\n//       });\n//   };\n\n//   return (\n//     <div>\n//       <form onSubmit={onSubmit}>\n//         <label htmlFor=\"email\">Email</label>\n//         <input\n//           value={email}\n//           onChange={(event) => setEmail(event.target.value)}\n//         ></input>\n//         <label htmlFor=\"password\">Password</label>\n//         <input\n//           value={password}\n//           onChange={(event) => setPassword(event.target.value)}\n//         ></input>\n//         <button type=\"submit\">Login</button>\n//       </form>\n//       <div\n//         className=\"fb-login-button\"\n//         data-width=\"\"\n//         data-size=\"large\"\n//         data-button-type=\"continue_with\"\n//         data-layout=\"default\"\n//         data-auto-logout-link=\"false\"\n//         data-use-continue-as=\"true\"\n//       ></div>\n//       <button onClick={checkLoginState} disabled={!fbLoaded}>\n//         Hi\n//       </button>\n//     </div>\n//   );\n// };\n\n// export default User_login;\n"],"mappings":"AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,IAAI,QAAQ,aAAa;AAClC,OAAOC,aAAa,MAAM,gBAAgB;;AAE1C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA"},"metadata":{},"sourceType":"module","externalDependencies":[]}