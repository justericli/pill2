import{__rest as i,__awaiter as o}from"tslib";import e,{forwardRef as r,useMemo as t,useState as l,useEffect as a}from"react";import n from"maplibre-gl";import{AmplifyMapLibreRequest as m}from"maplibre-gl-js-amplify";import s from"react-map-gl";import{Amplify as p,Auth as v}from"aws-amplify";const d=r(((r,d)=>{var u,f,c,{mapLib:g,mapStyle:y,style:b}=r,w=i(r,["mapLib","mapStyle","style"]);const h=p.configure(),L=t((()=>{var i,o,e,r;return null!==(r=null!==(o=null===(i=h.geo)||void 0===i?void 0:i.amazon_location_service)&&void 0!==o?o:null===(e=h.geo)||void 0===e?void 0:e.AmazonLocationService)&&void 0!==r?r:{}}),[h]),[S,j]=l(),q=t((()=>Object.assign({height:"100vh",position:"relative",width:"100vw"},b)),[b]);return a((()=>{o(void 0,void 0,void 0,(function*(){const i=yield v.currentUserCredentials();if(i){const{region:o}=L,{transformRequest:e}=new m(i,o);j((()=>e))}}))}),[L]),S?e.createElement(s,Object.assign({},w,{mapLib:null!=g?g:n,mapStyle:null!=y?y:null===(u=L.maps)||void 0===u?void 0:u.default,ref:d,style:q,transformRequest:S,fog:null!==(f=w.fog)&&void 0!==f?f:void 0,terrain:null!==(c=w.terrain)&&void 0!==c?c:void 0})):null}));d.displayName="MapView";export{d as MapView};
